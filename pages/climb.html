<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Đăng ký leo núi Bà Đen - Thông tin về lịch trình, quy định, hướng dẫn và đăng ký trực tuyến cho hoạt động leo núi.">
    <meta http-equiv="Content-Language" content="vi">
    <meta name="language" content="Vietnamese">
    <meta name="google" content="translate">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <title>Đăng ký leo núi - Khu du lịch quốc gia Núi Bà Đen</title>

    <link rel="icon" type="image/png" sizes="32x32" href="../assets/images/favicon-32x32.png">

    <!-- Preconnect to external domains for faster loading -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://cdn.tailwindcss.com">

    <!-- Critical CSS first -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/climb.css">

    <!-- Fonts with optimized loading -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Font Awesome - Load asynchronously -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer"></noscript>

    <!-- Tailwind CSS - Load synchronously to ensure configuration works -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Map-related CSS - Load synchronously -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.81.0/dist/L.Control.Locate.min.css">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css"></noscript>
    
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/material_blue.css"></noscript>

    <script>
        // Wait for Tailwind to be available
        if (typeof tailwind !== 'undefined') {
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: {
                                50: '#f0fdf4',
                                100: '#dcfce7',
                                200: '#bbf7d0',
                                300: '#86efac',
                                400: '#4ade80',
                                500: '#10b981',
                                600: '#047857',
                                700: '#047857',
                                800: '#065f46',
                                900: '#064e3b'
                            },
                            accent: {
                                50: '#f0f9ff',
                                100: '#e0f2fe',
                                200: '#bae6fd',
                                300: '#7dd3fc',
                                400: '#38bdf8',
                                500: '#0ea5e9',
                                600: '#0369a1',
                                700: '#0369a1',
                                800: '#075985',
                                900: '#0c4a6e',
                            }
                        },
                        fontFamily: {
                            sans: ['Inter', 'sans-serif']
                        }
                    }
                }
            }
        } else {
            // Fallback if Tailwind fails to load
            console.warn('Tailwind CSS not loaded, using fallback styles');
        }
    </script>
</head>
<body class="bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 text-gray-800 font-sans antialiased">

    <header class="bg-white/90 backdrop-blur-md sticky top-0 z-50 shadow-sm border-b border-gray-100">
        <div class="container mx-auto px-4 py-3">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-3">
                    <img src="../assets/images/android-chrome-512x512.png" alt="Logo Núi Bà Đen" class="w-12 h-12 rounded-full object-cover border-2 border-primary-100">
                    <div>
                        <h1 class="text-base sm:text-lg md:text-xl font-bold text-primary-600">Chinh phục Núi Bà Đen</h1>
                        <p class="text-xs text-gray-500 hidden sm:block">Tây Ninh, Việt Nam</p>
                    </div>
                </div>
                
                <nav class="hidden md:block">
                    <ul class="flex space-x-8 items-center">
                        <li><a href="../home.html" class="nav-link px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Trang chủ</a></li>
                        <li><a href="map.html" class="nav-link px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Bản đồ số</a></li>
                        <li><a href="guide.html" class="nav-link px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Cẩm nang du lịch</a></li>
                        <li><a href="climb.html" class="nav-link active px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Đăng ký leo núi</a></li>
                        <li><a href="../home.html#footer" class="nav-link px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Liên hệ</a></li>
                        <li>
                            <div class="language-selector ml-2" onclick="toggleLanguageMenu()">
                                <i class="fas fa-globe"></i>
                            </div>
                        </li>
                    </ul>
                </nav>
                
                <div class="flex items-center md:hidden">
                    <div class="language-selector mr-2" onclick="toggleLanguageMenu()">
                        <i class="fas fa-globe"></i>
                    </div>
                    <button id="mobile-menu-button" class="text-gray-700 hover:text-primary-700 focus:outline-none" aria-label="Mở menu điều hướng">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
            
            <div id="mobile-menu" class="hidden md:hidden mt-3 border-t border-gray-100 pt-3">
                <ul class="space-y-2">
                    <li><a href="../home.html" class="block px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Trang chủ</a></li>
                    <li><a href="map.html" class="block px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Bản đồ số</a></li>
                    <li><a href="guide.html" class="block px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Cẩm nang du lịch</a></li>
                    <li><a href="climb.html" class="block px-2 py-2 font-medium hover:text-primary-500 transition duration-200 bg-gray-50 rounded-md text-primary-500">Đăng ký leo núi</a></li>
                    <li><a href="../home.html#footer" class="block px-2 py-2 font-medium hover:text-primary-500 transition duration-200">Liên hệ</a></li>
                </ul>
            </div>
        </div>
    </header>

    <div id="messageBox" class="message-box z-[150]"></div>

    <div class="container mx-auto px-4 py-8 md:px-6 md:py-12 max-w-5xl">

        <header class="text-center mb-10 md:mb-16">
            <h1 class="text-3xl md:text-4xl lg:text-5xl font-bold text-green-800 mb-3 tracking-tight">Chinh phục Núi Bà Đen</h1>
            <p class="text-lg md:text-xl text-gray-600">Đăng ký chuyến đi, khám phá "Nóc nhà Nam Bộ" (986m) và nhận chứng nhận điện tử độc đáo.</p>
        </header>

        <main class="space-y-10 md:space-y-16">

            <section id="emergency" class="bg-red-100 border-l-4 border-red-600 text-red-800 p-5 rounded-lg shadow-md flex items-start space-x-4">
                <i class="fa-solid fa-triangle-exclamation text-2xl text-red-600 mt-1"></i>
                <div>
                    <h2 class="font-bold text-lg uppercase mb-2">Thông Tin Cứu Hộ Khẩn Cấp</h2>
                    <p class="mb-3">Trong trường hợp khẩn cấp trên đường leo núi, vui lòng liên hệ ngay Hotline:</p>
                    <a href="tel:02763875678" class="inline-flex items-center bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md text-lg transition duration-150 ease-in-out shadow hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2">
                        <i class="fa-solid fa-phone mr-2"></i>
                        <span>0276.387.5678</span>
                    </a>
                    <p class="mt-3 text-sm text-red-700">Luôn mang theo điện thoại, đảm bảo đủ pin và có sóng.</p>
                </div>
            </section>

             <section id="trekking-routes" class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <h2 class="text-2xl md:text-3xl font-semibold mb-6 text-indigo-700 border-b border-indigo-200 pb-4 flex items-center">
                    <i class="fa-solid fa-map-location-dot text-3xl text-indigo-600 mr-4"></i>
                    Bản đồ Tuyến đường Leo núi
                </h2>
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-800 mb-2">Tuyến đường Cột Điện (Chính thức)</h3>
                    <p class="text-sm text-gray-600 mb-4">Đây là tuyến đường được Ban Quản lý cho phép. Vui lòng đi đúng theo lộ trình được đánh dấu. Nhấn nút <i class="fa-solid fa-location-crosshairs"></i> trên bản đồ để xem vị trí của bạn.</p>
                    <div id="mapCanvas" class="w-full rounded-md border border-gray-300 shadow-sm bg-gray-200 z-0 relative">
                        <div class="flex items-center justify-center h-full text-gray-500">
                            <i class="fa-solid fa-spinner fa-spin mr-2"></i> Đang tải bản đồ...
                        </div>
                    </div>
                     <p class="text-xs text-gray-500 mt-2">Sử dụng nút +/- để phóng to/thu nhỏ.</p>
                    <!-- NÚT TẢI GPX MỚI -->
                    <div class="mt-4 text-center sm:text-left">
                        <button type="button" id="downloadGpxBtn" class="inline-flex items-center bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-4 rounded-md text-sm transition duration-150 ease-in-out shadow hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                            <i class="fa-solid fa-route mr-2"></i>
                            <span>Tải Tuyến đường GPX</span>
                        </button>
                    </div>
                    <!-- KẾT THÚC NÚT TẢI GPX MỚI -->
                </div>
            </section>

            <section id="regulations" class="bg-yellow-50 border border-yellow-300 p-6 rounded-lg shadow-sm">
                 <h2 class="text-xl font-semibold text-yellow-900 mb-5 flex items-center">
                     <i class="fa-solid fa-scroll text-2xl text-yellow-600 mr-3"></i>
                     Quy định An toàn & Bảo vệ Môi trường
                 </h2>
                 <p class="text-yellow-800 mb-4 text-sm">Vì sự an toàn của bạn và bảo tồn vẻ đẹp tự nhiên, vui lòng tuân thủ nghiêm ngặt các quy định sau:</p>
                 <ul class="list-none space-y-3 text-yellow-900 text-sm md:text-base">
                    <li class="flex items-start"><i class="fa-solid fa-shoe-prints text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Đi đúng đường mòn:</span> Luôn đi theo chỉ dẫn, không đi đường tắt.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-bottle-water text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Chuẩn bị kỹ lưỡng:</span> Mang đủ nước (1.5-2L+), thức ăn nhẹ, y tế cơ bản.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-shirt text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Trang phục & Trang bị:</span> Quần áo thoải mái, giày chuyên dụng, đèn pin, sạc dự phòng.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-cloud-sun-rain text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Kiểm tra thời tiết:</span> Xem dự báo, chuẩn bị áo mưa/áo khoác nếu cần.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-mobile-screen-button text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Thông báo lịch trình:</span> Cho người thân biết kế hoạch và thời gian dự kiến.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-trash-can text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Giữ gìn vệ sinh:</span> Mang toàn bộ rác xuống núi, không xả rác bừa bãi.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-leaf text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Bảo vệ thiên nhiên:</span> Không bẻ cành, hái hoa, khắc vẽ, săn bắt.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-fire-extinguisher text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Phòng chống cháy rừng:</span> Tuyệt đối không đốt lửa, hút thuốc sai quy định.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-people-group text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Giữ liên lạc:</span> Đi theo đoàn, không tách nhóm đi một mình.</span></li>
                    <li class="flex items-start"><i class="fa-solid fa-flag text-yellow-700 mr-3 mt-1 w-4 text-center"></i><span><span class="font-semibold">Báo cáo sự cố:</span> Gọi ngay Hotline cứu hộ nếu gặp sự cố hoặc nguy cơ.</span></li>
                 </ul>
             </section>

            <section id="registration" class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <h2 class="text-2xl md:text-3xl font-semibold mb-6 text-green-700 border-b border-green-200 pb-4 flex items-center">
                     <i class="fa-solid fa-clipboard-list text-3xl text-green-600 mr-4"></i>
                     Đăng ký thông tin leo núi
                </h2>
                <p class="text-sm text-gray-600 mb-8">Điền thông tin để Ban Quản lý hỗ trợ, nhận email xác nhận và cấp chứng nhận chinh phục.</p>

                <form id="registrationForm" novalidate class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-6">
                        <div class="space-y-5">
                            <div class="relative">
                                <label for="leaderName" class="block text-sm font-medium text-gray-700 mb-1">Họ tên Trưởng đoàn/Người đăng ký <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                    <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-user"></i></span>
                                    <input type="text" id="leaderName" name="leaderName" required class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="Nguyễn Văn An">
                                </div>
                            </div>
                            <div class="relative">
                                <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Số điện thoại <span class="text-red-500">*</span></label>
                                 <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-phone"></i></span>
                                     <input type="tel" id="phoneNumber" name="phoneNumber" required pattern="[0-9]{10,11}" title="Nhập số điện thoại hợp lệ (10-11 chữ số)" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="09XXXXXXXX">
                                 </div>
                                <p class="text-xs text-gray-500 mt-1">Dùng để xác thực nhận chứng nhận.</p>
                            </div>
                            <div class="relative">
                                <label for="birthday" class="block text-sm font-medium text-gray-700 mb-1">Ngày sinh <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                    <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-cake-candles"></i></span>
                                    <input type="text" id="birthday" name="birthday" required class="w-full py-2 border border-gray-300 rounded-md focus:ring-primary-500 focus:border-primary-500 shadow-sm">
                                </div>
                            </div>
                            <div class="relative">
                                <label for="cccd" class="block text-sm font-medium text-gray-700 mb-1">Căn cước công dân <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-id-card"></i></span>
                                     <input type="text" id="cccd" name="cccd" required pattern="[0-9]{12}" title="Nhập CCCD hợp lệ (12 chữ số)" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="123456789012">
                                 </div>
                                <p class="text-xs text-gray-500 mt-1">Nhập đầy đủ 12 số CCCD.</p>
                            </div>
                            <div class="relative">
                                <label for="address" class="block text-sm font-medium text-gray-700 mb-1">Địa chỉ (Tỉnh/Thành phố) <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-location-dot"></i></span>
                                     <input type="text" id="address" name="address" required class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="TP. Hồ Chí Minh">
                                 </div>
                            </div>
                             <div class="relative">
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Địa chỉ Email <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-envelope"></i></span>
                                     <input type="email" id="email" name="email" required class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="nguyenvana@email.com">
                                 </div>
                                <p class="text-xs text-gray-500 mt-1">Để nhận email xác nhận đăng ký.</p>
                            </div>
                        </div>

                        <div class="space-y-5">
                             <div class="relative">
                                <label for="groupSize" class="block text-sm font-medium text-gray-700 mb-1">Số lượng thành viên (cả trưởng đoàn) <span class="text-red-500">*</span></label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-users"></i></span>
                                     <input type="number" id="groupSize" name="groupSize" required min="1" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="Nhập số người">
                                 </div>
                            </div>
                            <div class="relative">
                                <label for="climbDate" class="block text-sm font-medium text-gray-700 mb-1">Ngày leo núi</label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-calendar-days"></i></span>
                                     <input type="date" id="climbDate" name="climbDate" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base">
                                 </div>
                            </div>
                            <div class="relative">
                                <label for="climbTime" class="block text-sm font-medium text-gray-700 mb-1">Giờ leo núi</label>
                                <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-clock"></i></span>
                                     <input type="time" id="climbTime" name="climbTime" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base">
                                 </div>
                            </div>
                             <div class="relative">
                                <label for="memberList" class="block text-sm font-medium text-gray-700 mb-1">Danh sách thành viên nhận chứng nhận</label>
                                <div class="flex items-start border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-green-500 focus-within:border-green-500">
                                     <span class="pl-3 pr-2 pt-2 text-gray-400"><i class="fa-solid fa-list-ul"></i></span>
                                    <textarea id="memberList" name="memberList" rows="3" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-base" placeholder="Nhập mỗi tên trên một dòng (tùy chọn)"></textarea>
                                 </div>
                                <p class="text-xs text-gray-500 mt-1">Nhập đầy đủ họ tên để in chứng nhận. Sẽ hiển thị để chọn khi nhận chứng nhận.</p>
                            </div>
                        </div>
                    </div>

                    <div class="pt-4 border-t border-gray-200">
                        <div class="flex items-start">
                            <div class="flex items-center h-5 mt-0.5">
                                <input id="safetyCommit" name="safetyCommit" type="checkbox" required class="focus:ring-green-500 h-4 w-4 text-green-600 border-gray-300 rounded">
                            </div>
                            <div class="ml-3 text-sm">
                                <label for="safetyCommit" class="font-medium text-gray-700">Tôi đã đọc, hiểu rõ và cam kết tuân thủ các <a href="#regulations" class="text-blue-600 hover:underline font-semibold">Quy định An toàn & Bảo vệ Môi trường</a> khi tham gia leo núi <span class="text-red-500">*</span></label>
                            </div>
                        </div>
                         <p id="safetyCommitError" class="text-xs text-red-600 mt-1 hidden ml-8">Vui lòng xác nhận cam kết.</p>
                    </div>

                    <div class="pt-2 flex flex-col sm:flex-row gap-3">
                        <button type="submit" id="registerBtn" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out flex items-center justify-center text-lg shadow hover:shadow-md disabled:opacity-60 disabled:cursor-not-allowed">
                            <i class="fa-solid fa-paper-plane mr-2"></i>
                            <span>Đăng ký</span>  
                            <div id="registerSpinner" class="spinner hidden"></div>
                        </button>

                    </div>
                    <p class="text-xs text-gray-500 mt-2">
                        <i class="fa-solid fa-info-circle mr-1"></i>
                        <strong>Đăng ký:</strong> Kiểm tra vị trí GPS tự động.
                    </p>
                </form>
            </section>

            <section id="certification" class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                 <h2 class="text-2xl md:text-3xl font-semibold mb-6 text-blue-700 border-b border-blue-200 pb-4 flex items-center">
                    <i class="fa-solid fa-award text-3xl text-blue-600 mr-4"></i>
                     Nhận Chứng nhận
                 </h2>
                 <p class="text-sm text-gray-600 mb-4">Khi đến <span class="font-semibold">đỉnh Núi Bà Đen</span> (trong bán kính 150m), nhập SĐT đã đăng ký để xác thực vị trí và chọn thành viên nhận chứng nhận.</p>

                 <div id="phoneVerificationArea">
                     <div class="mb-4 relative">
                         <label for="verifyPhoneNumber" class="block text-sm font-medium text-gray-700 mb-1">Nhập Số điện thoại đã đăng ký <span class="text-red-500">*</span></label>
                         <div class="flex items-center border border-gray-300 rounded-md shadow-sm focus-within:ring-1 focus-within:ring-blue-500 focus-within:border-blue-500">
                             <span class="pl-3 pr-2 text-gray-400"><i class="fa-solid fa-mobile-screen-button"></i></span>
                             <input type="tel" id="verifyPhoneNumber" name="verifyPhoneNumber" required pattern="[0-9]{10,11}" title="Nhập số điện thoại đã dùng để đăng ký" class="w-full py-2 border-0 rounded-r-md focus:ring-0 focus:outline-none text-sm" placeholder="Nhập lại SĐT đã đăng ký">
                         </div>
                     </div>
                     <div class="pt-2 flex flex-col sm:flex-row gap-3">
                         <button type="button" id="verifyPhoneBtn" class="w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 ease-in-out flex items-center justify-center text-lg shadow hover:shadow-md disabled:opacity-60 disabled:cursor-not-allowed">
                             <i class="fa-solid fa-location-crosshairs mr-2"></i>
                             <span>Xác thực</span> 
                             <div id="certSpinner" class="spinner hidden"></div>
                         </button>

                     </div>
                     <p class="text-xs text-gray-500 mt-2">
                         <i class="fa-solid fa-info-circle mr-1"></i>
                         <strong>Xác thực:</strong> Kiểm tra vị trí GPS tự động.
                     </p>
                 </div>

                 <div id="memberSelectionArea" class="mt-8 hidden border border-gray-200 rounded-lg p-4 md:p-6 bg-gray-50/50">
                     <h3 class="text-lg md:text-xl font-semibold text-gray-800 mb-3">Chọn thành viên & Tải ảnh (tùy chọn)</h3>
                     <p class="text-sm text-gray-600 mb-5">Đánh dấu chọn thành viên muốn nhận chứng nhận. Nhấn "Tải ảnh" để thêm hình ảnh cá nhân lên chứng nhận (bỏ qua nếu không muốn).</p>

                     <div id="memberListContainer" class="space-y-4 mb-6 max-h-96 overflow-y-auto border-t border-b border-gray-200 py-4">
                     </div>

                     <div class="flex flex-col sm:flex-row items-center gap-4 pt-4 border-t border-gray-200">
                         <button type="button" id="generateSelectedBtn" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150 ease-in-out flex items-center justify-center text-base shadow hover:shadow-md disabled:opacity-60 disabled:cursor-not-allowed">
                             <i class="fa-solid fa-file-pdf mr-2"></i>
                             <span>Tạo Chứng nhận</span> 
                             <div id="generateSpinner" class="spinner hidden"></div>
                         </button>
                         <button type="button" id="resetVerificationBtn" class="w-full sm:w-auto text-sm text-gray-500 hover:text-gray-700 hover:underline">
                            <i class="fa-solid fa-arrow-left mr-1"></i> Nhập SĐT khác 
                        </button>
                     </div>
                 </div>

                 <div id="certificateResult" class="mt-8 hidden bg-green-50 p-6 rounded-lg border border-green-300 shadow-sm transition-all duration-500 ease-out">
                     <h3 id="certificateResultTitle" class="text-xl font-semibold text-green-800 mb-3 flex items-center">
                         <i class="fa-solid fa-circle-check text-green-600 mr-2"></i>
                         <span></span>
                    </h3>
                     <p id="certificateResultMessage" class="mb-4 text-green-700"></p>
                     <ul id="downloadLinks" class="space-y-3">
                     </ul>
                 </div>

             </section>

        </main>

        <footer class="text-center mt-16 pt-8 border-t border-gray-200 text-sm text-gray-500">
              <p class="mt-1">Chúc quý khách có một chuyến đi an toàn và ý nghĩa!</p>
        </footer>
    </div>

    <!-- Modal Cam kết và Chữ ký -->
    <div id="commitmentModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[200] p-2 md:p-4 overflow-y-auto hidden">
        <div class="bg-white rounded-lg shadow-xl p-2 md:p-6 w-full max-w-2xl mx-auto max-h-[95vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg md:text-2xl font-bold text-gray-800">Cam kết đăng ký leo núi</h3>
                <button type="button" id="closeCommitmentBtn" class="text-gray-400 hover:text-gray-600 text-2xl">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <!-- Bản cam kết -->
            <div class="bg-blue-50 p-2 md:p-4 rounded-lg mb-4">
                <div class="text-center mb-4">
                    <div class="font-bold text-base md:text-lg uppercase mb-1">BẢN CAM KẾT TỰ NGUYỆN THAM GIA LEO NÚI</div>
                    <div class="italic text-sm md:text-base">(Tại Khu du lịch Quốc gia Núi Bà Đen)</div>
                    <div class="font-semibold mt-2">
                        <span class="font-bold">Kính gửi:</span> Ban quản lý Khu du lịch Quốc gia Núi Bà Đen
                    </div>
                </div>
                <div class="mb-2 text-sm md:text-base">
                    <div><strong>Họ tên:</strong> <span id="commitmentName"></span></div>
                    <div><strong>Ngày sinh:</strong> <span id="commitmentBirthday"></span></div>
                    <div><strong>CMND/CCCD số:</strong> <span id="commitmentCCCD"></span></div>
                    <div><strong>Địa chỉ thường trú:</strong> <span id="commitmentAddress"></span></div>
                    <div><strong>Số điện thoại liên hệ:</strong> <span id="commitmentPhone"></span></div>
                    <div><strong>Email:</strong> <span id="commitmentEmail"></span></div>
                    <div><strong>Số lượng thành viên:</strong> <span id="commitmentGroupSize"></span></div>
                    <div><strong>Ngày leo:</strong> <span id="commitmentDate"></span></div>
                    <div><strong>Giờ leo:</strong> <span id="commitmentTime"></span></div>
                </div>
                <!-- Nội dung cam kết giữ nguyên như hướng dẫn trước -->
                <div class="text-justify text-xs md:text-sm text-blue-700 space-y-2 leading-relaxed mt-2">
                    <p>
                        Vào ngày <span id="commitmentDay"></span> tháng <span id="commitmentMonth"></span> năm <span id="commitmentYear"></span>, nay tôi làm bản cam kết này để xác nhận việc tham gia hoạt động leo núi tại Núi Bà Đen, với các nội dung sau:
                    </p>
                    <p><strong>1. Tự nguyện tham gia:</strong> Tôi tự nguyện tham gia hoạt động leo núi, đã được lực lượng của Ban Quản lý phổ biến đầy đủ thông tin, hướng dẫn và nhận thức rõ về các nguy cơ, rủi ro có thể xảy ra trong quá trình tham gia hoạt động.</p>
                    <p><strong>2. Đảm bảo sức khỏe cá nhân:</strong> Tôi cam kết có đủ điều kiện sức khỏe để tham gia hoạt động leo núi, không mắc các bệnh lý nguy hiểm hoặc ảnh hưởng đến việc vận động. Tôi hoàn toàn chịu trách nhiệm về tình trạng sức khỏe của bản thân.</p>
                    <p><strong>3. Tuân thủ quy định và hướng dẫn:</strong> Cam kết chấp hành nghiêm túc mọi nội quy, quy định, hướng dẫn của Ban Quản lý Khu du lịch quốc gia Núi Bà Đen, lực lượng chức năng và người hướng dẫn trong suốt quá trình tham gia hoạt động.</p>
                    <p><strong>4. Cam kết bảo vệ môi trường và phòng cháy chữa cháy rừng:</strong></p>
                    <ul class="list-disc ml-6 space-y-1">
                        <li>Không xả rác, không hủy hoại tài nguyên rừng, hệ sinh thái rừng, công trình bảo vệ và phát triển rừng;</li>
                        <li>Không sử dụng lửa trong rừng, không mang theo hóa chất độc, chất nổ, chất cháy, chất dễ cháy vào rừng;</li>
                        <li>Không săn, bắt, nhốt, giết, tàng trữ, vận chuyển, buôn bán động vật rừng, thu thập mẫu vật các loài thực vật rừng, động vật rừng trái quy định của pháp luật.</li>
                    </ul>
                    <p><strong>5. Cam kết giữ gìn an ninh trật tự và an toàn cá nhân:</strong></p>
                    <ul class="list-disc ml-6 space-y-1">
                        <li>Không tổ chức, sử dụng, mua bán trái phép chất ma túy; Không tổ chức đánh bạc, cá độ dưới mọi hình thức trong quá trình leo núi trên lâm phần của Ban Quản lý;</li>
                        <li>Không tự ý tách đoàn, không đi vào các khu vực cấm hoặc địa hình nguy hiểm. Nếu vi phạm, tôi hoàn toàn chịu trách nhiệm trước pháp luật và các cơ quan có thẩm quyền.</li>
                    </ul>
                    <p><strong>6. Chấp nhận rủi ro và miễn trừ trách nhiệm:</strong> Trong trường hợp xảy ra tai nạn, thương tích hoặc sự cố ngoài ý muốn trong quá trình tham gia hoạt động, tôi cam kết tự chịu trách nhiệm và không khiếu nại, khiếu kiện Ban Tổ chức hoặc Ban Quản lý Khu du lịch dưới bất kỳ hình thức nào.</p>
                    <p class="mt-4 font-semibold">
                        Tôi làm cam kết này với tinh thần tự nguyện, trung thực và hoàn toàn chịu trách nhiệm trước pháp luật về các thông tin đã khai và nội dung cam kết trên./.
                    </p>
                </div>
            </div>
            <!-- Khu vực chữ ký -->
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-2 md:p-4 mb-4">
                <h4 class="text-base md:text-lg font-semibold text-gray-800 mb-2">Chữ ký xác nhận:</h4>
                <p class="text-xs md:text-sm text-gray-600 mb-2">Vui lòng ký tay vào ô bên dưới để xác nhận cam kết:</p>
                <canvas id="signatureCanvas" class="w-full h-32 md:h-48 border border-gray-300 rounded bg-white cursor-crosshair"></canvas>
                <div class="flex justify-between items-center mt-2">
                    <button type="button" id="clearSignatureBtn" class="text-xs md:text-sm text-red-600 hover:text-red-800">
                        <i class="fas fa-eraser mr-1"></i> Xóa chữ ký
                    </button>
                    <span class="text-xs text-gray-500">Ký bằng tay hoặc bút cảm ứng</span>
                </div>
            </div>
            <div class="flex justify-end space-x-2">
                <button type="button" id="cancelCommitmentBtn" class="py-2 px-4 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md font-medium text-xs md:text-sm">
                    Hủy bỏ
                </button>
                <button type="button" id="confirmCommitmentBtn" class="py-2 px-4 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-md text-xs md:text-sm">
                    <i class="fas fa-check mr-2"></i> Xác nhận cam kết
                </button>
            </div>
        </div>
    </div>

    <div id="cropModal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-[100] hidden p-4">
        <div class="bg-white rounded-lg shadow-xl p-5 max-w-xl w-full mx-auto">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">Cắt ảnh theo tỷ lệ yêu cầu</h3>
            <p class="text-sm text-gray-600 mb-4">Di chuyển và thay đổi kích thước vùng chọn để cắt ảnh.</p>
            <div class="mb-4 max-h-[60vh] overflow-hidden bg-gray-100 border border-gray-300 rounded">
                <img id="imageToCrop" src="" alt="Ảnh cần cắt" class="max-w-full block">
            </div>
            <div class="flex justify-end space-x-3">
                <button type="button" id="cancelCropBtn" class="py-2 px-4 bg-gray-300 hover:bg-gray-400 text-gray-800 rounded-md transition duration-150 ease-in-out text-sm font-medium">
                    Hủy bỏ
                </button>
                <button type="button" id="confirmCropBtn" class="py-2 px-4 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-md transition duration-150 ease-in-out text-sm">
                    <i class="fa-solid fa-crop-simple mr-1"></i> Xác nhận
                </button>
            </div>
        </div>
    </div>

    <!-- Load critical JavaScript first -->
    <script src="../js/cache-utils.js"></script>
    
    <!-- Load map-related JavaScript asynchronously when needed -->
    <!-- Load Leaflet and dependencies synchronously -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol@0.81.0/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    
    <script>
        // Lazy load cropper when needed
        function loadCropperJS() {
            if (window.Cropper) return Promise.resolve();
            
            return new Promise((resolve) => {
                const cropperScript = document.createElement('script');
                cropperScript.src = 'https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js';
                cropperScript.onload = resolve;
                document.head.appendChild(cropperScript);
            });
        }
        
        // Make loadCropperJS available globally
        window.loadCropperJS = loadCropperJS;
    </script>
    
    <!-- Load main climb script -->
    <script src="../js/climb.js?v=1.1"></script>

    <!-- Footer -->
    <footer id="footer" class="bg-white pt-16 pb-8 px-4 border-t border-gray-100 mt-auto">
        <div class="container mx-auto max-w-5xl">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mb-8">
                <div>
                    <div class="flex items-center space-x-3 mb-4">
                        <img src="../assets/images/android-chrome-512x512.png" alt="Logo Núi Bà Đen" class="w-10 h-10 rounded-full">
                        <h3 class="font-bold text-lg text-gray-800">KDL quốc gia Núi Bà Đen</h3>
                    </div>
                    <p class="text-gray-600 mb-4">"Nóc nhà Nam Bộ" - điểm đến tâm linh và du lịch sinh thái hấp dẫn hàng đầu Việt Nam.</p>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Liên kết nhanh</h3>
                    <ul class="space-y-2">
                        <li><a href="../home.html" class="text-gray-600 hover:text-primary-500 transition duration-200">Trang chủ</a></li>
                        <li><a href="map.html" class="text-gray-600 hover:text-primary-500 transition duration-200">Bản đồ số</a></li>
                        <li><a href="guide.html" class="text-gray-600 hover:text-primary-500 transition duration-200">Cẩm nang du lịch</a></li>
                        <li><a href="climb.html" class="text-gray-600 hover:text-primary-500 transition duration-200">Đăng ký leo núi</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold text-gray-800 mb-4">Thông tin liên hệ</h3>
                    <ul class="space-y-2">
                        <li class="flex items-start">
                            <i class="fas fa-envelope text-gray-400 mt-1.5 w-5"></i>
                            <a href="mailto:bqlnuiba@gmail.com" class="ml-2 text-gray-600 hover:text-primary-500 transition duration-200">bqlnuiba@gmail.com</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fab fa-facebook text-gray-400 mt-1.5 w-5"></i>
                            <a href="https://www.facebook.com/bqlkdlquocgianuibaden" target="_blank" class="ml-2 text-gray-600 hover:text-primary-500 transition duration-200">Fanpage Facebook</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fab fa-tiktok text-gray-400 mt-1.5 w-5"></i>
                            <a href="https://www.tiktok.com/@nuibadenbql" target="_blank" class="ml-2 text-gray-600 hover:text-primary-500 transition duration-200">nuibadenbql (TikTok)</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-globe text-gray-400 mt-1.5 w-5"></i>
                            <a href="http://khudulichnuibaden.tayninh.gov.vn" target="_blank" class="ml-2 text-gray-600 hover:text-primary-500 transition duration-200">khudulichnuibaden.tayninh.gov.vn</a>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-phone text-gray-400 mt-1.5 w-5"></i>
                            <a href="tel:02763823378" class="ml-2 text-gray-600 hover:text-primary-500 transition duration-200">0276 3823378</a>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-100 pt-6 text-center">
                <p class="text-gray-500 text-sm">&copy; <span id="currentYear"></span> Ban Quản lý Khu du lịch quốc gia Núi Bà Đen.</p>
            </div>
        </div>
    </footer>

    <!-- Load main script with defer -->
    <script src="../js/main.js" defer></script>

    <!-- Language Popup -->
    <div id="languagePopup" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-lg p-6 max-w-sm w-full mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Chọn ngôn ngữ</h3>
                <button onclick="toggleLanguageMenu()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="language-options space-y-2">
                <button onclick="translatePage('vi')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/vn.png" alt="VN" class="inline w-6 h-4 rounded-sm"></span>
                    <span>Tiếng Việt</span>
                </button>
                <button onclick="translatePage('en')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/gb.png" alt="GB" class="inline w-6 h-4 rounded-sm"></span>
                    <span>English</span>
                </button>
                <button onclick="translatePage('fr')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/fr.png" alt="FR" class="inline w-6 h-4 rounded-sm"></span>
                    <span>Français</span>
                </button>
                <button onclick="translatePage('de')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/de.png" alt="DE" class="inline w-6 h-4 rounded-sm"></span>
                    <span>Deutsch</span>
                </button>
                <button onclick="translatePage('ja')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/jp.png" alt="JP" class="inline w-6 h-4 rounded-sm"></span>
                    <span>日本語</span>
                </button>
                <button onclick="translatePage('ko')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/kr.png" alt="KR" class="inline w-6 h-4 rounded-sm"></span>
                    <span>한국어</span>
                </button>
                <button onclick="translatePage('zh-CN')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/cn.png" alt="CN" class="inline w-6 h-4 rounded-sm"></span>
                    <span>中文</span>
                </button>
                <button onclick="translatePage('ru')" class="w-full text-left px-4 py-2 rounded hover:bg-gray-100 flex items-center">
                    <span class="mr-2"><img src="https://flagcdn.com/24x18/ru.png" alt="RU" class="inline w-6 h-4 rounded-sm"></span>
                    <span>Русский</span>
                </button>
            </div>
        </div>
    </div>
    <style>
    body .goog-te-banner-frame.skiptranslate {
        display: none !important;
    }
    body {
        top: 0px !important;
    }
    .skiptranslate, .skiptranslate * {
        display: none !important;
        visibility: hidden !important;
        height: 0 !important;
        width: 0 !important;
        position: absolute !important;
        top: -9999px !important;
        left: -9999px !important;
    }
    </style>
    <script type="text/javascript">
        function toggleLanguageMenu() {
            const popup = document.getElementById('languagePopup');
            if (popup.classList.contains('hidden')) {
                popup.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            } else {
                popup.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }
        function translatePage(langCode) {
            document.cookie = `googtrans=/${langCode}; path=/; domain=.${window.location.hostname}`;
            document.cookie = `googtrans=/${langCode}; path=/; domain=${window.location.hostname}`;
            window.location.reload();
        }
        document.getElementById('languagePopup').addEventListener('click', function(e) {
            if (e.target === this) {
                toggleLanguageMenu();
            }
        });
        function loadGoogleTranslate() {
            var script = document.createElement('script');
            script.src = '//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit';
            document.body.appendChild(script);
        }
        function googleTranslateElementInit() {
            new google.translate.TranslateElement({
                pageLanguage: 'vi',
                includedLanguages: 'en,fr,de,ja,ko,zh-CN,ru',
                layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
                autoDisplay: false
            }, 'google_translate_element');
        }
        window.onload = loadGoogleTranslate;
    </script>

    <!-- Load date picker asynchronously when needed -->
    <script>
        // Lazy load Flatpickr when date inputs are focused
        function loadFlatpickr() {
            if (window.flatpickr) return Promise.resolve();
            
            return new Promise((resolve) => {
                const flatpickrScript = document.createElement('script');
                flatpickrScript.src = 'https://cdn.jsdelivr.net/npm/flatpickr';
                flatpickrScript.onload = function() {
                    // Load Vietnamese locale
                    const localeScript = document.createElement('script');
                    localeScript.src = 'https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/vn.js';
                    localeScript.onload = resolve;
                    document.head.appendChild(localeScript);
                };
                document.head.appendChild(flatpickrScript);
            });
        }
        
        // Initialize date picker when needed
        document.addEventListener('DOMContentLoaded', function() {
            const dateInputs = document.querySelectorAll('input[type="date"], #birthday, #climbDate');
            dateInputs.forEach(input => {
                input.addEventListener('focus', function() {
                    loadFlatpickr().then(() => {
                        if (!input.flatpickr) {
                            flatpickr(input, {
                                locale: 'vn',
                                dateFormat: input.type === 'date' ? 'Y-m-d' : 'd/m/Y'
                            });
                        }
                    });
                }, { once: true });
            });
        });
    </script>
</body>
</html>